/*
 * jQuery EasyTabs plugin 3.2.0
 *
 * Copyright (c) 2010-2011 Steve Schwartz (JangoSteve)
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Date: Thu May 09 17:30:00 2013 -0500
 */
(function(e){e.easytabs=function(t,n){var r=this,i=e(t),s={animate:true,panelActiveClass:"active",tabActiveClass:"active",defaultTab:"li:first-child",animationSpeed:"normal",tabs:"> ul > li",updateHash:true,cycle:false,collapsible:false,collapsedClass:"collapsed",collapsedByDefault:true,uiTabs:false,transitionIn:"fadeIn",transitionOut:"fadeOut",transitionInEasing:"swing",transitionOutEasing:"swing",transitionCollapse:"slideUp",transitionUncollapse:"slideDown",transitionCollapseEasing:"swing",transitionUncollapseEasing:"swing",containerClass:"",tabsClass:"",tabClass:"",panelClass:"",cache:true,event:"click",touchevent:"touchend",panelContext:i},o,u,a,f,l,c={fast:200,normal:400,slow:600},h=false,p;r.init=function(){r.settings=p=e.extend({},s,n);p.bind_str=p.event+".easytabs";p.touchbind_str=p.touchevent+".easytabs";if(p.uiTabs){p.tabActiveClass="ui-tabs-selected";p.containerClass="ui-tabs ui-widget ui-widget-content ui-corner-all";p.tabsClass="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all";p.tabClass="ui-state-default ui-corner-top";p.panelClass="ui-tabs-panel ui-widget-content ui-corner-bottom"}if(p.collapsible&&n.defaultTab!==undefined&&n.collpasedByDefault===undefined){p.collapsedByDefault=false}if(typeof p.animationSpeed==="string"){p.animationSpeed=c[p.animationSpeed]}e("a.anchor").remove().prependTo("body");i.data("easytabs",{});r.setTransitions();r.getTabs();v();m();y();S();x();i.attr("data-easytabs",true)};r.setTransitions=function(){a=p.animate?{show:p.transitionIn,hide:p.transitionOut,speed:p.animationSpeed,collapse:p.transitionCollapse,uncollapse:p.transitionUncollapse,halfSpeed:p.animationSpeed/2}:{show:"show",hide:"hide",speed:0,collapse:"hide",uncollapse:"show",halfSpeed:0}};r.getTabs=function(){var t;r.tabs=i.find(p.tabs),r.panels=e(),r.tabs.each(function(){var n=e(this),i=n.children("a"),s=n.children("a").data("target");n.data("easytabs",{});if(s!==undefined&&s!==null){n.data("easytabs").ajax=i.attr("href")}else{s=i.attr("href")}s=s.match(/#([^\?]+)/)[1];t=p.panelContext.find("#"+s);if(t.length){t.data("easytabs",{position:t.css("position"),visibility:t.css("visibility")});t.not(p.panelActiveClass).hide();r.panels=r.panels.add(t);n.data("easytabs").panel=t}else{r.tabs=r.tabs.not(n);if("console"in window){console.warn("Warning: tab without matching panel for selector '#"+s+"' removed from set")}}})};r.selectTab=function(e,t){var n=window.location,i=n.hash.match(/^[^\?]*/)[0],s=e.parent().data("easytabs").panel,o=e.parent().data("easytabs").ajax;if(p.collapsible&&!l&&(e.hasClass(p.tabActiveClass)||e.hasClass(p.collapsedClass))){r.toggleTabCollapse(e,s,o,t)}else if(!e.hasClass(p.tabActiveClass)||!s.hasClass(p.panelActiveClass)){b(e,s,o,t)}else if(!p.cache){b(e,s,o,t)}};r.toggleTabCollapse=function(e,t,n,s){r.panels.stop(true,true);if(d(i,"easytabs:before",[e,t,p])){r.tabs.filter("."+p.tabActiveClass).removeClass(p.tabActiveClass).children().removeClass(p.tabActiveClass);if(e.hasClass(p.collapsedClass)){if(n&&(!p.cache||!e.parent().data("easytabs").cached)){i.trigger("easytabs:ajax:beforeSend",[e,t]);t.load(n,function(n,r,s){e.parent().data("easytabs").cached=true;i.trigger("easytabs:ajax:complete",[e,t,n,r,s])})}e.parent().removeClass(p.collapsedClass).addClass(p.tabActiveClass).children().removeClass(p.collapsedClass).addClass(p.tabActiveClass);t.addClass(p.panelActiveClass)[a.uncollapse](a.speed,p.transitionUncollapseEasing,function(){i.trigger("easytabs:midTransition",[e,t,p]);if(typeof s=="function")s()})}else{e.addClass(p.collapsedClass).parent().addClass(p.collapsedClass);t.removeClass(p.panelActiveClass)[a.collapse](a.speed,p.transitionCollapseEasing,function(){i.trigger("easytabs:midTransition",[e,t,p]);if(typeof s=="function")s()})}}};r.matchTab=function(e){return r.tabs.find("[href='"+e+"'],[data-target='"+e+"']").first()};r.matchInPanel=function(e){return e&&r.validId(e)?r.panels.filter(":has("+e+")").first():[]};r.validId=function(e){return e.substr(1).match(/^[A-Za-z][A-Za-z0-9\-_:\.]*$/)};r.selectTabFromHashChange=function(){var e=window.location.hash.match(/^[^\?]*/)[0],t=r.matchTab(e),n;if(p.updateHash){if(t.length){l=true;r.selectTab(t)}else{n=r.matchInPanel(e);if(n.length){e="#"+n.attr("id");t=r.matchTab(e);l=true;r.selectTab(t)}else if(!o.hasClass(p.tabActiveClass)&&!p.cycle){if(e===""||r.matchTab(f).length||i.closest(e).length){l=true;r.selectTab(u)}}}}};r.cycleTabs=function(t){if(p.cycle){t=t%r.tabs.length;$tab=e(r.tabs[t]).children("a").first();l=true;r.selectTab($tab,function(){setTimeout(function(){r.cycleTabs(t+1)},p.cycle)})}};r.publicMethods={select:function(t){var n;if((n=r.tabs.filter(t)).length===0){if((n=r.tabs.find("a[href='"+t+"']")).length===0){if((n=r.tabs.find("a"+t)).length===0){if((n=r.tabs.find("[data-target='"+t+"']")).length===0){if((n=r.tabs.find("a[href$='"+t+"']")).length===0){e.error("Tab '"+t+"' does not exist in tab set")}}}}}else{n=n.children("a").first()}r.selectTab(n)}};var d=function(t,n,r){var i=e.Event(n);t.trigger(i,r);return i.result!==false};var v=function(){i.addClass(p.containerClass);r.tabs.parent().addClass(p.tabsClass);r.tabs.addClass(p.tabClass);r.panels.addClass(p.panelClass)};var m=function(){var t=window.location.hash.match(/^[^\?]*/)[0],n=r.matchTab(t).parent(),i;if(n.length===1){o=n;p.cycle=false}else{i=r.matchInPanel(t);if(i.length){t="#"+i.attr("id");o=r.matchTab(t).parent()}else{o=r.tabs.parent().find(p.defaultTab);if(o.length===0){e.error("The specified default tab ('"+p.defaultTab+"') could not be found in the tab set ('"+p.tabs+"') out of "+r.tabs.length+" tabs.")}}}u=o.children("a").first();g(n)};var g=function(t){var n,r;if(p.collapsible&&t.length===0&&p.collapsedByDefault){o.addClass(p.collapsedClass).children().addClass(p.collapsedClass)}else{n=e(o.data("easytabs").panel);r=o.data("easytabs").ajax;if(r&&(!p.cache||!o.data("easytabs").cached)){i.trigger("easytabs:ajax:beforeSend",[u,n]);n.load(r,function(e,t,r){o.data("easytabs").cached=true;i.trigger("easytabs:ajax:complete",[u,n,e,t,r])})}o.data("easytabs").panel.show().addClass(p.panelActiveClass);o.addClass(p.tabActiveClass)}i.trigger("easytabs:initialised",[u,n])};var y=function(){r.tabs.children("a").bind(p.bind_str+" "+p.touchbind_str,function(t){if(!h&&event.type==="touchend"){h=true;r.tabs.children("a").unbind(p.bind_str)}p.cycle=false;l=false;r.selectTab(e(this));t.preventDefault?t.preventDefault():t.returnValue=false})};var b=function(e,t,n,s){r.panels.stop(true,true);if(d(i,"easytabs:before",[e,t,p])){var o=r.panels.filter(":visible"),u=t.parent(),c,h,v,m,g=window.location.hash.match(/^[^\?]*/)[0];if(p.animate){c=w(t);h=o.length?E(o):0;v=c-h}f=g;m=function(){i.trigger("easytabs:midTransition",[e,t,p]);if(p.animate&&p.transitionIn=="fadeIn"){if(v<0)u.animate({height:u.height()+v},a.halfSpeed).css({"min-height":""})}if(p.updateHash&&!l){window.location.hash="#"+t.attr("id")}else{l=false}t[a.show](a.speed,p.transitionInEasing,function(){u.css({height:"","min-height":""});i.trigger("easytabs:after",[e,t,p]);if(typeof s=="function"){s()}})};if(n&&(!p.cache||!e.parent().data("easytabs").cached)){i.trigger("easytabs:ajax:beforeSend",[e,t]);t.load(n,function(n,r,s){e.parent().data("easytabs").cached=true;i.trigger("easytabs:ajax:complete",[e,t,n,r,s])})}if(p.animate&&p.transitionOut=="fadeOut"){if(v>0){u.animate({height:u.height()+v},a.halfSpeed)}else{u.css({"min-height":u.height()})}}r.tabs.filter("."+p.tabActiveClass).removeClass(p.tabActiveClass).children().removeClass(p.tabActiveClass);r.tabs.filter("."+p.collapsedClass).removeClass(p.collapsedClass).children().removeClass(p.collapsedClass);e.parent().addClass(p.tabActiveClass);r.panels.filter("."+p.panelActiveClass).removeClass(p.panelActiveClass);t.addClass(p.panelActiveClass);if(o.length){o[a.hide](a.speed,p.transitionOutEasing,m)}else{t[a.uncollapse](a.speed,p.transitionUncollapseEasing,m)}}};var w=function(t){if(t.data("easytabs")&&t.data("easytabs").lastHeight){return t.data("easytabs").lastHeight}var n=t.css("display"),r,i;try{r=e("<div></div>",{position:"absolute",visibility:"hidden",overflow:"hidden"})}catch(s){r=e("<div></div>",{visibility:"hidden",overflow:"hidden"})}i=t.wrap(r).css({position:"relative",visibility:"hidden",display:"block"}).outerHeight();t.unwrap();t.css({position:t.data("easytabs").position,visibility:t.data("easytabs").visibility,display:n});t.data("easytabs").lastHeight=i;return i};var E=function(e){var t=e.outerHeight();if(e.data("easytabs")){e.data("easytabs").lastHeight=t}else{e.data("easytabs",{lastHeight:t})}return t};var S=function(){if(typeof e(window).hashchange==="function"){e(window).hashchange(function(){r.selectTabFromHashChange()})}else if(e.address&&typeof e.address.change==="function"){e.address.change(function(){r.selectTabFromHashChange()})}};var x=function(){var e;if(p.cycle){e=r.tabs.index(o);setTimeout(function(){r.cycleTabs(e+1)},p.cycle)}};r.init()};e.fn.easytabs=function(t){var n=arguments;return this.each(function(){var r=e(this),i=r.data("easytabs");if(undefined===i){i=new e.easytabs(this,t);r.data("easytabs",i)}if(i.publicMethods[t]){return i.publicMethods[t](Array.prototype.slice.call(n,1))}})}})(jQuery)
